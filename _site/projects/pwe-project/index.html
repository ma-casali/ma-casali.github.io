<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Parabolic Wave Equation Solver | Matthew Casali</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="Parabolic Wave Equation Solver" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Computational model for acoustic radiation using an IFD class of solution to the parabolic wave equation." />
<meta property="og:description" content="Computational model for acoustic radiation using an IFD class of solution to the parabolic wave equation." />
<link rel="canonical" href="http://localhost:4000/projects/pwe-project/" />
<meta property="og:url" content="http://localhost:4000/projects/pwe-project/" />
<meta property="og:site_name" content="Matthew Casali" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-10-01T00:00:00-07:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Parabolic Wave Equation Solver" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-01T00:00:00-07:00","datePublished":"2025-10-01T00:00:00-07:00","description":"Computational model for acoustic radiation using an IFD class of solution to the parabolic wave equation.","headline":"Parabolic Wave Equation Solver","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/projects/pwe-project/"},"url":"http://localhost:4000/projects/pwe-project/"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Matthew Casali" /><script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

  <link rel="stylesheet" href="/assets/css/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  
</head>


<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Matthew Casali</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/">Home</a><a class="page-link" href="/my-a-projects.html">Projects</a><a class="page-link" href="/my-b-music.html">Music</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Parabolic Wave Equation Solver</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2025-10-01T00:00:00-07:00" itemprop="datePublished">Oct 1, 2025
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <script type="text/javascript" async="" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

<p><a href="https://github.com/ma-casali/acoustic-models">See the current project files here!</a></p>

<h1 id="why-focus-on-solving-the-parabolic-wave-equation-pwe">Why focus on solving the parabolic wave equation (PWE)?</h1>

<p>Noise control and communications rely heavily on knowing exactly how sound will travel over large distances. While there are plenty of analytical models for sound propagation over short distances and within enclosures, they can not extend easily to large-expanding spaces. This is where the parabolic wave equation comes in! An efficient solver of this equation, can model sound propagation over tens of kilometers under a minute. I built my version of this solver to provide acousticians with a free, fast, and reliable software product to aid them in noise analysis.</p>

<h1 id="what-is-the-parabolic-wave-equation">What is the Parabolic Wave Equation?</h1>

<p>The parabolic wave equation is derived from the Helmholtz Wave Equation in polar coordinates (with no azimuthal dependence),</p>

\[\frac{\partial^2}{\partial r^2} + 
\frac{1}{r}\frac{\partial p}{\partial r} +
\frac{\partial^2 p}{\partial z^2} + 
k_0^2n^2p = 0\]

<p>which, when coupled with the paraxial approximation, \(\frac{\partial^2 \psi} {\partial r^2} = 2ik_0 \frac{\partial \psi}{\partial r}\), the wave equation results in,</p>

\[\frac{\partial \psi}{\partial r} = ik_0 \left(\sqrt{n^2 + \frac{1}{k_0}\frac{\partial^2}{\partial z^2} - 1}\right)\psi\]

<p>where, \(n^2 = c^2/c_0^2\).</p>

<h1 id="solving-the-parabolic-wave-equation-with-the-implicit-finite-difference-ifd-method">Solving the Parabolic Wave Equation with the Implicit Finite Difference (IFD) method.</h1>

<p>The IFD method takes the definition of the derivative and relates a prior step in \(r\) to the next step via the derivative defined within the parabolic wave approximation.</p>

<p>The user provides the algorithm with a starting field \(\psi(r = 0, z)\) that then steps the field forward along the range by \(k \) to solve for the whole field.</p>

<h1 id="my-implementation-of-a-pwe-solver">My implementation of a PWE solver.</h1>

<p>In addition to implementing the parabolic wave equation as an efficient solution method for acoustic propagation by equipping the solver with GPU capability, I also made sure to implement the ability for the solver to work with arbitrary terrains.</p>

<p>The following is the core of the algorithm:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">nn</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">r_mesh</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>

    <span class="c1"># From Eq. 6.189 (Jensen, Computational Ocean Acoustics)
</span>    <span class="n">A</span><span class="p">,</span> <span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">build_system_matrices</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="n">k_steps</span><span class="p">[</span><span class="n">nn</span><span class="p">],</span> <span class="n">k_0_sq_h_sq</span><span class="p">,</span> <span class="n">sqrt_approx_vec</span><span class="p">)</span>
    <span class="bp">self</span><span class="p">.</span><span class="n">u</span><span class="p">[</span><span class="n">nn</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">solve_tridiagonal_matrix_eq</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="bp">self</span><span class="p">.</span><span class="n">u</span><span class="p">[</span><span class="n">nn</span><span class="p">,</span> <span class="p">:])</span>

    <span class="c1"># set boundaries to zero pressure
</span>    <span class="bp">self</span><span class="p">.</span><span class="n">u</span><span class="p">[</span><span class="n">nn</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># pressure release
</span>    <span class="bp">self</span><span class="p">.</span><span class="n">u</span><span class="p">[</span><span class="n">nn</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># absorbing layer
</span>    
    <span class="k">if</span> <span class="n">progress_callback</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="n">nn</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">r_mesh</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<p>This takes in things like the range step \(k \), constants, and the square-root approximations to build the two tri-diagonal matrices from Eq. 6.189 from Jensen’s Computational Ocean Acoustics. It then solves that matrix equation, for the “nn+1” step of u (the field variable), and continues on iterating.</p>

<p>Some examples of the solutions to the PWE for different environments are shown below:</p>

<div style="text-align: center;">
    <img src="/assets/images/Air_PWESolve.png" alt="PWE Solve in Air" style="width: 100%;" />
    <p style="text-align: center; font-size: 0.8em;"><em>A solution in air where f = 10 Hz</em></p>
</div>

<div style="text-align: center;">
        <img src="/assets/images/Water_PWESolve.png" alt="Solve in Water" style="width: 100%;" />
    <p style="text-align: center; font-size: 0.8em;"><em>A solution in water where f = 25 Hz</em></p>
</div>


  </div><a class="u-url" href="/projects/pwe-project/" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Matthew Casali</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Matthew Casali</li><li><a class="u-email" href="mailto:casali.ma98@gmail.com">casali.ma98@gmail.com</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ma-casali"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ma-casali</span></a></li><li><a href="https://www.linkedin.com/in/matthew-casali-761158133"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#linkedin"></use></svg> <span class="username">matthew-casali-761158133</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>I am an acoustic engineer that focuses on hardware development, real-time DSP, and machine learning among other random projects!</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
